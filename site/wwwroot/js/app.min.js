(function(){"use strict";angular.module("timeline",[])})(),function(){"use strict";var n=function(n,t,i,r,u){var f=this;f.type=undefined;f.init=function(n){f.type=n;r.getData(n).length===0&&r.read(n).then(i.inject)};f.getData=function(){return r.getData(f.type)};f.readMore=function(){u.is()||(r.read(f.type),i.click(f.type,"Read More"))};f.open=function(n){t.open(n.Url,"_blank");i.click(f.type,"Read")};f.toggleSocials=function(n){n.socials?(n.socials=!1,i.click(f.type,"Close Share")):(n.socials=!0,i.click(f.type,"Open Share"))};f.shareVk=function(n){t.open("http://vk.com/share.php?url="+n.Url,"_blank");i.click(f.type,"Share with VK")};f.shareTw=function(n){t.open("https://twitter.com/intent/tweet?text="+n.Title+"&url="+n.Url+"&via=bstutimeline","_blank");i.click(f.type,"Share with Twitter")};f.shareFb=function(n){t.open("http://www.facebook.com/sharer/sharer.php?u="+n.Url,"_blank");i.click(f.type,"Share with FB")};n.news={init:f.init,getData:f.getData,readMore:f.readMore,open:f.open,toggleSocials:f.toggleSocials,share:{vk:f.shareVk,tw:f.shareTw,fb:f.shareFb}}};angular.module("timeline").controller("NewsCtrl",["$scope","$window","AnalyticsSvc","NewsSvc","LoadingSvc",n])}(),function(){"use strict";var n=function(n,t,i,r,u){var f=this;f.showSpinner=function(){return i.is()&&(r.getData("Feed").length===0&&t.isActive("feed")||r.getData("Upcoming").length===0&&t.isActive("upcoming"))};f.showSpinnerSmall=function(){return i.is()&&(r.getData("Feed").length>0&&t.isActive("feed")||r.getData("Upcoming").length>0&&t.isActive("upcoming"))};f.toTopAnalytics=function(){var n=t.active[0].toUpperCase()+t.active.substring(1);u.click(n,"Back to the top")};f.trackLink=function(n,t){u.click(n,t)};n.root={types:t,showSpinner:f.showSpinner,showSpinnerSmall:f.showSpinnerSmall,toTopAnalytics:f.toTopAnalytics,trackLink:f.trackLink}};angular.module("timeline").controller("RootCtrl",["$scope","TypesSvc","LoadingSvc","NewsSvc","AnalyticsSvc",n])}(),function(){"use strict";var n=function(n){var t=function(t,i,r){var u=parseInt(r.showAfter),f=parseInt(r.stickOn);u||(u=450);f||(f=180);i.addClass("hidden");angular.element(n).on("scroll",function(){var t=n.document.body.scrollHeight-n.document.body.scrollTop-n.document.body.clientHeight;t<=f?i.addClass("stick"):i.removeClass("stick");n.document.body.scrollTop>=u?i.removeClass("hidden"):i.addClass("hidden")});i.on("click",function(){n.scrollTo(0,0)})};return{restrict:"E",link:t}};angular.module("timeline").directive("toTop",["$window",n])}(),function(){"use strict";var n=function(n){var t=this;return t.trackingCode="UA-62450305-3",t.counters={},t.queue=[],t.attemp=0,t.maxAttemps=30,t.inited=!1,t.injected=!1,t.inject=function(){t.injected||(t.injected=!0,function(n,t,i,r,u,f,e){n.GoogleAnalyticsObject=u;n[u]=n[u]||function(){(n[u].q=n[u].q||[]).push(arguments)};n[u].l=1*new Date;f=t.createElement(i);e=t.getElementsByTagName(i)[0];f.async=1;f.src=r;e.parentNode.insertBefore(f,e)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"))},t.checkAvailability=function(){if(typeof ga!="function"){if(t.attemp++,t.attemp>t.maxAttemps)return;n(t.checkAvailability,1e3)}else ga(t.init)},t.init=function(){ga("create",t.trackingCode,"auto");ga("send","pageview");t.inited=!0;for(var n=0;n<t.queue;n++)ga("send","event",t.queue[n].category,t.queue[n].type,t.queue[n].label)},t.getCounter=function(n){return t.counters.hasOwnProperty(n)?(t.counters[n]++,t.counters[n]):(t.counters[n]=1,1)},t.click=function(n,i){var r=t.getCounter(n+i);i=i+" #"+r;t.inited?ga("send","event",n,"click",i):t.queue.push({type:"click",category:n,label:i})},t.checkAvailability(),t};angular.module("timeline").factory("AnalyticsSvc",["$timeout",n])}(),function(){"use strict";var n=function(){var n=this;return n.queue=[],n.is=function(){return n.queue.length!==0},n.begin=function(){n.queue.push(0)},n.end=function(){n.queue.pop()},n};angular.module("timeline").factory("LoadingSvc",[n])}(),function(){"use strict";var n=function(n,t){var i=this;return i.data={},i.getData=function(n){return i.data[n]||(i.data[n]=[]),i.data[n]},i.read=function(r){t.begin();i.data[r]||(i.data[r]=[]);var u="/api/news/"+r+"?skip="+i.data[r].length;return n.get(u).then(function(n){for(var t=0;t<n.data.length;t++)i.data[r].push(n.data[t])}).finally(function(){t.end()})},i};angular.module("timeline").factory("NewsSvc",["$http","LoadingSvc",n])}(),function(){"use strict";var n=function(n){var t=this;return t.list=[{id:"feed",text:"\u041b\u0435\u043d\u0442\u0430"},{id:"upcoming",text:"\u0411\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435"}],t.active=t.list[0].id,t.isActive=function(n){return t.active===n},t.activate=function(i){t.active=i;n.click("Go to",i)},t};angular.module("timeline").factory("TypesSvc",["AnalyticsSvc",n])}();