(function(){"use strict";var n=function(){var n=this;return n.list=[{id:"feed",text:"\u041b\u0435\u043d\u0442\u0430"},{id:"actual",text:"\u0410\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0435"}],n.active=n.list[0].id,n.isActive=function(t){return n.active===t},n.activate=function(t){n.active=t},n},t=function(){var n=this;return n.queue=[],n.is=function(){return n.queue.length!==0},n.begin=function(){n.queue.push(0)},n.end=function(){n.queue.pop()},n},i=function(n,t,i,r,u){n.types=t;n.showSpinner=function(){return i.is()&&(r.data.length===0&&t.isActive("feed")||u.data.length===0&&t.isActive("actual"))};n.showSpinnerSmall=function(){return i.is()&&r.data.length>0}},r=function(n,t){var i=this;return i.data=[],i.read=function(){t.begin();n.get("/api/news/feed?skip="+i.data.length).then(function(n){for(var t=0;t<n.data.length;t++)i.data.push(n.data[t])}).finally(function(){t.end()})},i},u=function(n,t,i,r,u){n.news=r.data;n.readMore=function(){u.is()||(r.read(),i.click("Feed","Read More"))};n.open=function(n){t.open(n,"_blank");i.click("Feed","Read")};r.data.length===0&&r.read()},f=function(n,t){var i=this;return i.data=[],i.read=function(){t.begin();n.get("/api/news/actual").then(function(n){for(var t=0;t<n.data.length;t++)i.data.push(n.data[t])}).finally(function(){t.end()})},i},e=function(n,t,i,r,u){n.news=r.data;n.goToFeed=function(){u.activate("feed");t.scrollTo(0,0);i.click("Actual","Go to feed")};n.open=function(n){t.open(n,"_blank");i.click("Actual","Read")};r.data.length===0&&r.read()},o=function(n){var t=function(t,i,r){var u=parseInt(r.showAfter);u||(u=450);i.addClass("hidden");angular.element(n).on("scroll",function(){n.document.body.scrollTop>u?i.removeClass("hidden"):i.addClass("hidden")});i.on("click",function(){n.scrollTo(0,0)})};return{restrict:"E",link:t}},s=function(){var n=this;return n.counters={},n.getCounter=function(t){return n.counters.hasOwnProperty(t)?(n.counters[t]++,n.counters[t]):(n.counters[t]=1,1)},n.click=function(t,i){var r=n.getCounter(t+i);ga("send","event",t,"click",i+" #"+r)},n};angular.module("timeline",[]).factory("TypesSvc",["$window",n]).factory("LoadingSvc",[t]).controller("RootCtrl",["$scope","TypesSvc","LoadingSvc","FeedSvc","ActualSvc",i]).factory("FeedSvc",["$http","LoadingSvc",r]).controller("FeedCtrl",["$scope","$window","AnalyticsSvc","FeedSvc","LoadingSvc",u]).factory("ActualSvc",["$http","LoadingSvc",f]).controller("ActualCtrl",["$scope","$window","AnalyticsSvc","ActualSvc","TypesSvc",e]).directive("toTop",["$window",o]).factory("AnalyticsSvc",["$timeout",s])})();